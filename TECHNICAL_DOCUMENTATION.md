# EduChain æ•™è‚²çŸ¥è¯†å…±äº«å¹³å° - æŠ€æœ¯å¼€å‘æ–‡æ¡£

> **ç‰ˆæœ¬**: v1.0.0  
> **æœ€åæ›´æ–°**: 2025-01-01  
> **ç»´æŠ¤è€…**: EduChain å¼€å‘å›¢é˜Ÿ

---

## ğŸ“‘ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [ç³»ç»Ÿæ¶æ„è®¾è®¡](#2-ç³»ç»Ÿæ¶æ„è®¾è®¡)
3. [æŠ€æœ¯æ ˆè¯¦è§£](#3-æŠ€æœ¯æ ˆè¯¦è§£)
4. [åŒºå—é“¾é›†æˆæ–¹æ¡ˆ](#4-åŒºå—é“¾é›†æˆæ–¹æ¡ˆ)
5. [æ•°æ®åº“è®¾è®¡](#5-æ•°æ®åº“è®¾è®¡)
6. [API è®¾è®¡è§„èŒƒ](#6-api-è®¾è®¡è§„èŒƒ)
7. [å‰åç«¯å¼€å‘æŒ‡å—](#7-å‰åç«¯å¼€å‘æŒ‡å—)
8. [å®‰å…¨æœºåˆ¶](#8-å®‰å…¨æœºåˆ¶)
9. [æ€§èƒ½ä¼˜åŒ–](#9-æ€§èƒ½ä¼˜åŒ–)
10. [éƒ¨ç½²æ–¹æ¡ˆ](#10-éƒ¨ç½²æ–¹æ¡ˆ)
11. [å¼€å‘è§„èŒƒ](#11-å¼€å‘è§„èŒƒ)
12. [æµ‹è¯•ç­–ç•¥](#12-æµ‹è¯•ç­–ç•¥)
13. [ç›‘æ§ä¸è¿ç»´](#13-ç›‘æ§ä¸è¿ç»´)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç®€ä»‹

EduChain æ˜¯ä¸€ä¸ªåŸºäºåŒºå—é“¾æŠ€æœ¯çš„æ•™è‚²çŸ¥è¯†å…±äº«å¹³å°ï¼Œæ—¨åœ¨ä¸ºæ•™è‚²å·¥ä½œè€…å’Œå­¦ä¹ è€…æä¾›ä¸€ä¸ªå®‰å…¨ã€é€æ˜ã€å¯ä¿¡çš„çŸ¥è¯†åˆ†äº«å’Œè®¤è¯ç¯å¢ƒã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½

- **çŸ¥è¯†å†…å®¹ç®¡ç†**: æ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ã€æ–‡æ¡£ç­‰å¤šç§æ ¼å¼çš„çŸ¥è¯†åˆ†äº«
- **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ**: åŸºäº JWT çš„å®‰å…¨è®¤è¯æœºåˆ¶
- **äº’åŠ¨åŠŸèƒ½**: ç‚¹èµã€æ”¶è—ã€è¯„è®ºã€å…³æ³¨ç­‰ç¤¾äº¤åŠŸèƒ½
- **æœç´¢æ¨è**: å…¨æ–‡æœç´¢ã€æ™ºèƒ½æ¨èã€çƒ­é—¨å†…å®¹
- **åŒºå—é“¾å­˜è¯**: çŸ¥è¯†å†…å®¹ç‰ˆæƒä¿æŠ¤ã€å­¦ä¹ æˆå°±è®¤è¯
- **ç®¡ç†å‘˜ç³»ç»Ÿ**: å†…å®¹å®¡æ ¸ã€ç”¨æˆ·ç®¡ç†ã€ç³»ç»Ÿç›‘æ§

### 1.3 æŠ€æœ¯ç‰¹ç‚¹

- **å‰åç«¯åˆ†ç¦»**: React + Spring Boot æ¶æ„
- **å¾®æœåŠ¡åŒ–**: åŒºå—é“¾æœåŠ¡ç‹¬ç«‹éƒ¨ç½²
- **é«˜å¯ç”¨æ€§**: Redis ç¼“å­˜ã€æ•°æ®åº“ä¼˜åŒ–
- **å®‰å…¨æ€§**: JWT è®¤è¯ã€æ¥å£é™æµã€æ•°æ®åŠ å¯†
- **å¯æ‰©å±•æ€§**: æ¨¡å—åŒ–è®¾è®¡ã€å®¹å™¨åŒ–éƒ¨ç½²

---

## 2. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å±‚                                 â”‚
â”‚              Webæµè§ˆå™¨ / ç§»åŠ¨ç«¯åº”ç”¨                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯å±‚ (Frontend)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  React 19 + TypeScript + Vite                         â”‚  â”‚
â”‚  â”‚  - ç»„ä»¶åŒ–å¼€å‘                                          â”‚  â”‚
â”‚  â”‚  - è·¯ç”±ç®¡ç† (React Router)                            â”‚  â”‚
â”‚  â”‚  - çŠ¶æ€ç®¡ç† (Context API)                             â”‚  â”‚
â”‚  â”‚  - UIç»„ä»¶åº“ (Ant Design)                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP/HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APIç½‘å…³å±‚ (Gateway)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Nginx åå‘ä»£ç†                                       â”‚  â”‚
â”‚  â”‚  - è´Ÿè½½å‡è¡¡                                           â”‚  â”‚
â”‚  â”‚  - SSL/TLS ç»ˆæ­¢                                       â”‚  â”‚
â”‚  â”‚  - è¯·æ±‚è·¯ç”±                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯æœåŠ¡å±‚      â”‚            â”‚  åŒºå—é“¾æœåŠ¡å±‚      â”‚
â”‚  (Backend)      â”‚            â”‚  (Blockchain)     â”‚
â”‚                 â”‚            â”‚                   â”‚
â”‚  Spring Boot    â”‚â—„â”€â”€HTTPâ”€â”€â”€â–ºâ”‚  Python FastAPI   â”‚
â”‚  - RESTful API  â”‚            â”‚  - åŒºå—é“¾æ ¸å¿ƒ      â”‚
â”‚  - ä¸šåŠ¡é€»è¾‘      â”‚            â”‚  - å­˜è¯æœåŠ¡        â”‚
â”‚  - å®‰å…¨è®¤è¯      â”‚            â”‚  - éªŒè¯æœåŠ¡        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚              â”‚              â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚ MySQL â”‚ â”‚ Redis   â”‚ â”‚ æ–‡ä»¶å­˜å‚¨   â”‚ â”‚ æ¶ˆæ¯é˜Ÿåˆ—  â”‚
â”‚       â”‚ â”‚         â”‚ â”‚           â”‚ â”‚ (å¯é€‰)    â”‚
â”‚ ä¸»åº“  â”‚ â”‚ ç¼“å­˜    â”‚ â”‚ æœ¬åœ°/OSS   â”‚ â”‚ RabbitMQ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åˆ†å±‚æ¶æ„

#### 2.2.1 å‰ç«¯åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          è¡¨ç°å±‚ (Presentation)           â”‚
â”‚  - Pages (é¡µé¢ç»„ä»¶)                      â”‚
â”‚  - Components (UIç»„ä»¶)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic)      â”‚
â”‚  - Services (APIè°ƒç”¨)                    â”‚
â”‚  - Hooks (ä¸šåŠ¡é€»è¾‘å°è£…)                  â”‚
â”‚  - Utils (å·¥å…·å‡½æ•°)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         çŠ¶æ€ç®¡ç†å±‚ (State Management)    â”‚
â”‚  - Context API (å…¨å±€çŠ¶æ€)                â”‚
â”‚  - Local Storage (æœ¬åœ°å­˜å‚¨)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åŸºç¡€è®¾æ–½å±‚ (Infrastructure)      â”‚
â”‚  - Router (è·¯ç”±)                        â”‚
â”‚  - HTTP Client (ç½‘ç»œè¯·æ±‚)                â”‚
â”‚  - Error Handling (é”™è¯¯å¤„ç†)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.2 åç«¯åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ§åˆ¶å™¨å±‚ (Controller Layer)       â”‚
â”‚  - RESTful API æ¥å£                     â”‚
â”‚  - è¯·æ±‚å‚æ•°éªŒè¯                          â”‚
â”‚  - å“åº”æ•°æ®å°è£…                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æœåŠ¡å±‚ (Service Layer)           â”‚
â”‚  - ä¸šåŠ¡é€»è¾‘å¤„ç†                          â”‚
â”‚  - äº‹åŠ¡ç®¡ç†                              â”‚
â”‚  - å¼‚å¸¸å¤„ç†                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ•°æ®è®¿é—®å±‚ (Repository Layer)     â”‚
â”‚  - JPA Repository                       â”‚
â”‚  - è‡ªå®šä¹‰æŸ¥è¯¢                            â”‚
â”‚  - æ•°æ®æŒä¹…åŒ–                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        å®ä½“å±‚ (Entity Layer)            â”‚
â”‚  - æ•°æ®åº“å®ä½“æ˜ å°„                        â”‚
â”‚  - å…³ç³»æ˜ å°„                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 æ¨¡å—åˆ’åˆ†

#### 2.3.1 åç«¯æ¨¡å—

```
com.example.educhain/
â”œâ”€â”€ controller/          # æ§åˆ¶å™¨å±‚
â”‚   â”œâ”€â”€ AuthController.java
â”‚   â”œâ”€â”€ UserController.java
â”‚   â”œâ”€â”€ KnowledgeItemController.java
â”‚   â”œâ”€â”€ SearchController.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ service/            # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ UserService.java
â”‚   â”œâ”€â”€ KnowledgeItemService.java
â”‚   â”œâ”€â”€ BlockchainService.java  # åŒºå—é“¾æœåŠ¡æ¥å£
â”‚   â””â”€â”€ ...
â”œâ”€â”€ repository/         # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ UserRepository.java
â”‚   â”œâ”€â”€ KnowledgeItemRepository.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ entity/            # å®ä½“ç±»
â”‚   â”œâ”€â”€ User.java
â”‚   â”œâ”€â”€ KnowledgeItem.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ dto/               # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ UserDTO.java
â”‚   â”œâ”€â”€ KnowledgeItemDTO.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ config/            # é…ç½®ç±»
â”‚   â”œâ”€â”€ SecurityConfig.java
â”‚   â”œâ”€â”€ RedisConfig.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ util/              # å·¥å…·ç±»
â”‚   â”œâ”€â”€ JwtUtil.java
â”‚   â””â”€â”€ ...
â””â”€â”€ exception/         # å¼‚å¸¸å¤„ç†
    â”œâ”€â”€ GlobalExceptionHandler.java
    â””â”€â”€ ...
```

#### 2.3.2 å‰ç«¯æ¨¡å—

```
frontend/src/
â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Home.tsx
â”‚   â”œâ”€â”€ knowledge/
â”‚   â”œâ”€â”€ user/
â”‚   â””â”€â”€ admin/
â”œâ”€â”€ components/        # UIç»„ä»¶
â”‚   â”œâ”€â”€ common/
â”‚   â”œâ”€â”€ knowledge/
â”‚   â”œâ”€â”€ layout/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ services/          # APIæœåŠ¡
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ knowledge.ts
â”‚   â””â”€â”€ blockchain.ts  # åŒºå—é“¾æœåŠ¡
â”œâ”€â”€ contexts/          # ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ AuthContext.tsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ hooks/             # è‡ªå®šä¹‰Hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â””â”€â”€ ...
â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ api.ts
â”‚   â””â”€â”€ ...
â””â”€â”€ types/             # ç±»å‹å®šä¹‰
    â”œâ”€â”€ api.ts
    â””â”€â”€ ...
```

---

## 3. æŠ€æœ¯æ ˆè¯¦è§£

### 3.1 åç«¯æŠ€æœ¯æ ˆ

#### 3.1.1 æ ¸å¿ƒæ¡†æ¶

**Spring Boot 3.2.0**
- **ç‰ˆæœ¬**: 3.2.0
- **Javaç‰ˆæœ¬**: 21
- **ç‰¹æ€§**:
  - è‡ªåŠ¨é…ç½®
  - å†…åµŒTomcatæœåŠ¡å™¨
  - ç”Ÿäº§å°±ç»ªç‰¹æ€§ï¼ˆActuatorï¼‰
  - ä¾èµ–ç®¡ç†

**ä¸»è¦ä¾èµ–**:
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-security</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
</dependency>
```

#### 3.1.2 æ•°æ®æŒä¹…åŒ–

**Spring Data JPA**
- ORMæ¡†æ¶: Hibernate
- æ•°æ®åº“: MySQL 8.0+
- è¿æ¥æ± : HikariCP
- å®¡è®¡åŠŸèƒ½: JPA Auditing

**é…ç½®ç¤ºä¾‹**:
```yaml
spring:
  jpa:
    hibernate:
      ddl-auto: none
    show-sql: false
    properties:
      hibernate:
        format_sql: false
    open-in-view: false
```

#### 3.1.3 å®‰å…¨æ¡†æ¶

**Spring Security + JWT**
- è®¤è¯æ–¹å¼: JWT Token
- Tokenè¿‡æœŸæ—¶é—´: 24å°æ—¶
- åˆ·æ–°Token: 7å¤©
- å¯†ç åŠ å¯†: BCrypt

**JWTé…ç½®**:
```yaml
jwt:
  secret: ${JWT_SECRET:your-secret-key}
  expiration: 86400000  # 24å°æ—¶
  refresh-expiration: 604800000  # 7å¤©
```

#### 3.1.4 ç¼“å­˜

**Redis**
- ç”¨é€”: ä¼šè¯å­˜å‚¨ã€çƒ­ç‚¹æ•°æ®ç¼“å­˜
- è¿æ¥æ± : Lettuce
- åºåˆ—åŒ–: Jackson2JsonRedisSerializer

**é…ç½®ç¤ºä¾‹**:
```yaml
spring:
  data:
    redis:
      host: localhost
      port: 6379
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
```

#### 3.1.5 APIæ–‡æ¡£

**Swagger/OpenAPI**
- ç‰ˆæœ¬: SpringDoc OpenAPI 2.5.0
- è®¿é—®è·¯å¾„: `/swagger-ui.html`
- APIæ–‡æ¡£è·¯å¾„: `/v3/api-docs`

### 3.2 å‰ç«¯æŠ€æœ¯æ ˆ

#### 3.2.1 æ ¸å¿ƒæ¡†æ¶

**React 19.2.0**
- ç‰¹æ€§: Hooksã€å‡½æ•°ç»„ä»¶ã€æ€§èƒ½ä¼˜åŒ–
- æ„å»ºå·¥å…·: Vite 7.2.4
- è¯­è¨€: TypeScript 5.9.3

**ä¸»è¦ç‰¹æ€§**:
- ç»„ä»¶åŒ–å¼€å‘
- è™šæ‹ŸDOM
- å•å‘æ•°æ®æµ
- Hooks API

#### 3.2.2 UIæ¡†æ¶

**Ant Design 6.0.0**
- ç»„ä»¶åº“: ä¸°å¯Œçš„UIç»„ä»¶
- ä¸»é¢˜å®šåˆ¶: æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜
- å›½é™…åŒ–: æ”¯æŒå¤šè¯­è¨€

**ä½¿ç”¨ç¤ºä¾‹**:
```tsx
import { Button, Table, Form } from 'antd';

const MyComponent = () => {
  return (
    <Button type="primary">ç‚¹å‡»</Button>
  );
};
```

#### 3.2.3 è·¯ç”±ç®¡ç†

**React Router 7.9.6**
- è·¯ç”±æ¨¡å¼: BrowserRouter
- æ‡’åŠ è½½: React.lazy()
- è·¯ç”±å®ˆå«: ProtectedRoute

**é…ç½®ç¤ºä¾‹**:
```tsx
import { createBrowserRouter } from 'react-router-dom';

const router = createBrowserRouter([
  {
    path: '/',
    element: <Layout />,
    children: [
      { path: 'knowledge', element: <KnowledgeList /> }
    ]
  }
]);
```

#### 3.2.4 HTTPå®¢æˆ·ç«¯

**Axios 1.13.2**
- è¯·æ±‚æ‹¦æˆªå™¨: Tokenè‡ªåŠ¨æ·»åŠ 
- å“åº”æ‹¦æˆªå™¨: ç»Ÿä¸€é”™è¯¯å¤„ç†
- è¶…æ—¶è®¾ç½®: 10ç§’

**é…ç½®ç¤ºä¾‹**:
```typescript
import axios from 'axios';

const api = axios.create({
  baseURL: '/api',
  timeout: 10000,
});

api.interceptors.request.use(config => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});
```

### 3.3 æ•°æ®åº“

**MySQL 8.0+**
- å­—ç¬¦é›†: utf8mb4
- æ’åºè§„åˆ™: utf8mb4_unicode_ci
- å­˜å‚¨å¼•æ“: InnoDB
- è¿æ¥æ± : HikariCP

**æ•°æ®åº“é…ç½®**:
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/educhain_db
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
```

### 3.4 å¼€å‘å·¥å…·

**ä»£ç è´¨é‡**:
- ESLint: ä»£ç æ£€æŸ¥
- Prettier: ä»£ç æ ¼å¼åŒ–
- Spotless: Javaä»£ç æ ¼å¼åŒ–

**æ„å»ºå·¥å…·**:
- Maven: Javaé¡¹ç›®æ„å»º
- Vite: å‰ç«¯æ„å»ºå·¥å…·
- Docker: å®¹å™¨åŒ–éƒ¨ç½²

---

## 4. åŒºå—é“¾é›†æˆæ–¹æ¡ˆ

### 4.1 æ¶æ„è®¾è®¡

#### 4.1.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Spring Boot åç«¯æœåŠ¡             â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   BlockchainService (æ¥å£)        â”‚  â”‚
â”‚  â”‚   - certifyKnowledge()            â”‚  â”‚
â”‚  â”‚   - verifyKnowledge()             â”‚  â”‚
â”‚  â”‚   - certifyAchievement()          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTTP REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Python åŒºå—é“¾æœåŠ¡ (FastAPI)          â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   åŒºå—é“¾æ ¸å¿ƒæ¨¡å—                    â”‚  â”‚
â”‚  â”‚   - Block (åŒºå—)                   â”‚  â”‚
â”‚  â”‚   - Blockchain (é“¾)                â”‚  â”‚
â”‚  â”‚   - Transaction (äº¤æ˜“)               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   æ•°æ®å­˜å‚¨                          â”‚  â”‚
â”‚  â”‚   - SQLite/PostgreSQL              â”‚  â”‚
â”‚  â”‚   - æ–‡ä»¶ç³»ç»Ÿå¤‡ä»½                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.2 æŠ€æœ¯é€‰å‹

**Pythonæ¡†æ¶**: FastAPI
- é«˜æ€§èƒ½å¼‚æ­¥æ¡†æ¶
- è‡ªåŠ¨APIæ–‡æ¡£ç”Ÿæˆ
- ç±»å‹æç¤ºæ”¯æŒ
- æ˜“äºä¸Spring Booté›†æˆ

**åŒºå—é“¾å®ç°**:
- è½»é‡çº§è‡ªå»ºåŒºå—é“¾å­˜è¯ç³»ç»Ÿ
- å“ˆå¸Œé“¾ç»“æ„ï¼ˆæ•°æ®ä¸å¯ç¯¡æ”¹ï¼‰
- æ—¶é—´æˆ³éªŒè¯
- ç›´æ¥è®¡ç®—å“ˆå¸Œï¼ˆä¸æ¶‰åŠå·¥ä½œé‡è¯æ˜ï¼‰

**æ•°æ®å­˜å‚¨**:
- SQLiteï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- PostgreSQLï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- æ–‡ä»¶ç³»ç»Ÿå¤‡ä»½

### 4.2 åŒºå—é“¾æ ¸å¿ƒå®ç°

#### 4.2.1 åŒºå—ç»“æ„

```python
from dataclasses import dataclass
from datetime import datetime
from typing import List
import hashlib
import json

@dataclass
class Transaction:
    """äº¤æ˜“ç»“æ„"""
    type: str  # KNOWLEDGE_CERT, ACHIEVEMENT, COPYRIGHT
    knowledge_id: int = None
    user_id: int = None
    content_hash: str = None
    metadata: dict = None
    timestamp: str = None
    
    def to_dict(self):
        return {
            'type': self.type,
            'knowledge_id': self.knowledge_id,
            'user_id': self.user_id,
            'content_hash': self.content_hash,
            'metadata': self.metadata or {},
            'timestamp': self.timestamp or datetime.utcnow().isoformat()
        }
    
    def to_json(self):
        return json.dumps(self.to_dict(), sort_keys=True)

@dataclass
class Block:
    """åŒºå—ç»“æ„"""
    index: int
    timestamp: str
    transactions: List[Transaction]
    previous_hash: str
    nonce: int = 0
    hash: str = None
    
    def calculate_hash(self):
        """è®¡ç®—åŒºå—å“ˆå¸Œ"""
        block_string = json.dumps({
            'index': self.index,
            'timestamp': self.timestamp,
            'transactions': [tx.to_dict() for tx in self.transactions],
            'previous_hash': self.previous_hash
        }, sort_keys=True)
        return hashlib.sha256(block_string.encode()).hexdigest()
```

#### 4.2.2 åŒºå—é“¾å®ç°

```python
class Blockchain:
    """åŒºå—é“¾æ ¸å¿ƒç±»"""
    
    def __init__(self):
        self.chain: List[Block] = []
        self.pending_transactions: List[Transaction] = []
        self.create_genesis_block()
    
    def create_genesis_block(self):
        """åˆ›å»ºåˆ›ä¸–åŒºå—"""
        genesis_block = Block(
            index=0,
            timestamp=datetime.utcnow().isoformat(),
            transactions=[],
            previous_hash='0' * 64
        )
        genesis_block.hash = genesis_block.calculate_hash()
        self.chain.append(genesis_block)
    
    def get_latest_block(self) -> Block:
        """è·å–æœ€æ–°åŒºå—"""
        return self.chain[-1]
    
    def add_transaction(self, transaction: Transaction):
        """æ·»åŠ äº¤æ˜“åˆ°å¾…å¤„ç†é˜Ÿåˆ—"""
        self.pending_transactions.append(transaction)
        return self.get_latest_block().index + 1
    
    def create_block(self):
        """åˆ›å»ºæ–°åŒºå—ï¼ˆæ‰“åŒ…å¾…å¤„ç†äº¤æ˜“ï¼‰
        
        å°†å¾…å¤„ç†çš„å­˜è¯äº¤æ˜“æ‰“åŒ…æˆæ–°åŒºå—ï¼Œç›´æ¥è®¡ç®—å“ˆå¸Œå¹¶æ·»åŠ åˆ°é“¾ä¸­
        ä¸æ¶‰åŠå·¥ä½œé‡è¯æ˜æˆ–æŒ–çŸ¿
        """
        if not self.pending_transactions:
            return None
        
        block = Block(
            index=len(self.chain),
            timestamp=datetime.utcnow().isoformat(),
            transactions=self.pending_transactions.copy(),
            previous_hash=self.get_latest_block().hash
        )
        
        self.chain.append(block)
        self.pending_transactions = []
        return block
    
    def is_chain_valid(self) -> bool:
        """éªŒè¯åŒºå—é“¾æœ‰æ•ˆæ€§"""
        for i in range(1, len(self.chain)):
            current_block = self.chain[i]
            previous_block = self.chain[i - 1]
            
            # éªŒè¯å½“å‰åŒºå—å“ˆå¸Œ
            if current_block.hash != current_block.calculate_hash():
                return False
            
            # éªŒè¯ä¸å‰ä¸€ä¸ªåŒºå—çš„è¿æ¥
            if current_block.previous_hash != previous_block.hash:
                return False
        
        return True
    
    def get_transaction_by_knowledge_id(self, knowledge_id: int) -> Transaction:
        """æ ¹æ®çŸ¥è¯†IDæŸ¥æ‰¾äº¤æ˜“"""
        for block in self.chain:
            for transaction in block.transactions:
                if (transaction.type == 'KNOWLEDGE_CERT' and 
                    transaction.knowledge_id == knowledge_id):
                    return transaction
        return None
    
    def verify_knowledge(self, knowledge_id: int, content_hash: str) -> bool:
        """éªŒè¯çŸ¥è¯†å†…å®¹"""
        transaction = self.get_transaction_by_knowledge_id(knowledge_id)
        if not transaction:
            return False
        return transaction.content_hash == content_hash
```

### 4.3 FastAPIæœåŠ¡å®ç°

#### 4.3.1 APIæ¥å£

```python
from fastapi import FastAPI, HTTPException, BackgroundTasks
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel
from typing import Optional, List
from datetime import datetime

app = FastAPI(title="EduChain Blockchain Service", version="1.0.0")

# CORSé…ç½®
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # ç”Ÿäº§ç¯å¢ƒåº”é™åˆ¶å…·ä½“åŸŸå
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# åˆå§‹åŒ–åŒºå—é“¾
blockchain = Blockchain()

# æ•°æ®æ¨¡å‹
class CertifyRequest(BaseModel):
    type: str  # KNOWLEDGE_CERT, ACHIEVEMENT, COPYRIGHT
    knowledge_id: Optional[int] = None
    user_id: int
    content_hash: str
    metadata: Optional[dict] = None

class VerifyRequest(BaseModel):
    knowledge_id: int
    content_hash: str

class TransactionResponse(BaseModel):
    transaction_id: int
    block_index: int
    status: str
    timestamp: str

class VerifyResponse(BaseModel):
    is_valid: bool
    block_index: Optional[int] = None
    transaction_timestamp: Optional[str] = None

# APIç«¯ç‚¹
@app.post("/api/blockchain/certify", response_model=TransactionResponse)
async def certify(request: CertifyRequest):
    """å­˜è¯æ¥å£"""
    try:
        transaction = Transaction(
            type=request.type,
            knowledge_id=request.knowledge_id,
            user_id=request.user_id,
            content_hash=request.content_hash,
            metadata=request.metadata,
            timestamp=datetime.utcnow().isoformat()
        )
        
        block_index = blockchain.add_transaction(transaction)
        
        # ç«‹å³åˆ›å»ºåŒºå—ï¼ˆæ‰“åŒ…äº¤æ˜“ï¼‰
        # blockchain.create_block()
        
        return TransactionResponse(
            transaction_id=len(blockchain.pending_transactions),
            block_index=block_index,
            status="pending",
            timestamp=transaction.timestamp
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))

@app.post("/api/blockchain/verify", response_model=VerifyResponse)
async def verify(request: VerifyRequest):
    """éªŒè¯æ¥å£"""
    try:
        is_valid = blockchain.verify_knowledge(
            request.knowledge_id,
            request.content_hash
        )
        
        transaction = blockchain.get_transaction_by_knowledge_id(
            request.knowledge_id
        )
        
        return VerifyResponse(
            is_valid=is_valid,
            block_index=transaction.block.index if transaction else None,
            transaction_timestamp=transaction.timestamp if transaction else None
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))

@app.get("/api/blockchain/chain")
async def get_chain():
    """è·å–åŒºå—é“¾ä¿¡æ¯"""
    return {
        "chain_length": len(blockchain.chain),
        "pending_transactions": len(blockchain.pending_transactions),
        "is_valid": blockchain.is_chain_valid()
    }

@app.post("/api/blockchain/create-block")
async def create_block():
    """æ‰‹åŠ¨åˆ›å»ºæ–°åŒºå—"""
    block = blockchain.create_block()
    if block:
        return {
            "message": "Block created successfully",
            "block_index": block.index,
            "transactions_count": len(block.transactions)
        }
    return {"message": "No pending transactions"}

@app.get("/api/blockchain/transaction/{knowledge_id}")
async def get_transaction(knowledge_id: int):
    """æ ¹æ®çŸ¥è¯†IDè·å–äº¤æ˜“ä¿¡æ¯"""
    transaction = blockchain.get_transaction_by_knowledge_id(knowledge_id)
    if not transaction:
        raise HTTPException(status_code=404, detail="Transaction not found")
    return transaction.to_dict()
```

#### 4.3.2 æ•°æ®æŒä¹…åŒ–

```python
from sqlalchemy import create_engine, Column, Integer, String, Text, DateTime
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from datetime import datetime

Base = declarative_base()

class BlockModel(Base):
    __tablename__ = 'blocks'
    
    id = Column(Integer, primary_key=True)
    index = Column(Integer, unique=True)
    timestamp = Column(DateTime)
    previous_hash = Column(String(64))
    hash = Column(String(64))
    nonce = Column(Integer)
    transactions_json = Column(Text)  # JSONæ ¼å¼å­˜å‚¨äº¤æ˜“

class BlockchainDB:
    """åŒºå—é“¾æ•°æ®åº“ç®¡ç†"""
    
    def __init__(self, db_url: str = "sqlite:///blockchain.db"):
        self.engine = create_engine(db_url)
        Base.metadata.create_all(self.engine)
        self.Session = sessionmaker(bind=self.engine)
    
    def save_block(self, block: Block):
        """ä¿å­˜åŒºå—åˆ°æ•°æ®åº“"""
        session = self.Session()
        try:
            block_model = BlockModel(
                index=block.index,
                timestamp=datetime.fromisoformat(block.timestamp),
                previous_hash=block.previous_hash,
                hash=block.hash,
                nonce=block.nonce,
                transactions_json=json.dumps([tx.to_dict() for tx in block.transactions])
            )
            session.add(block_model)
            session.commit()
        except Exception as e:
            session.rollback()
            raise e
        finally:
            session.close()
    
    def load_chain(self) -> List[Block]:
        """ä»æ•°æ®åº“åŠ è½½åŒºå—é“¾"""
        session = self.Session()
        try:
            block_models = session.query(BlockModel).order_by(BlockModel.index).all()
            chain = []
            for model in block_models:
                transactions = [
                    Transaction(**tx_dict) 
                    for tx_dict in json.loads(model.transactions_json)
                ]
                block = Block(
                    index=model.index,
                    timestamp=model.timestamp.isoformat(),
                    transactions=transactions,
                    previous_hash=model.previous_hash,
                    nonce=model.nonce,
                    hash=model.hash
                )
                chain.append(block)
            return chain
        finally:
            session.close()
```

### 4.4 Spring Booté›†æˆ

#### 4.4.1 æœåŠ¡æ¥å£

```java
package com.example.educhain.service;

import com.example.educhain.dto.BlockchainCertifyRequest;
import com.example.educhain.dto.BlockchainVerifyResponse;

public interface BlockchainService {
    /**
     * çŸ¥è¯†å†…å®¹å­˜è¯
     */
    String certifyKnowledge(Long knowledgeId, Long userId, String contentHash);
    
    /**
     * ç”¨æˆ·æˆå°±è®¤è¯
     */
    String certifyAchievement(Long userId, String achievementType, String achievementHash);
    
    /**
     * éªŒè¯çŸ¥è¯†å†…å®¹
     */
    BlockchainVerifyResponse verifyKnowledge(Long knowledgeId, String contentHash);
    
    /**
     * è·å–äº¤æ˜“ä¿¡æ¯
     */
    Object getTransaction(Long knowledgeId);
}
```

#### 4.4.2 æœåŠ¡å®ç°

```java
package com.example.educhain.service.impl;

import com.example.educhain.service.BlockchainService;
import com.example.educhain.dto.BlockchainCertifyRequest;
import com.example.educhain.dto.BlockchainVerifyResponse;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.scheduling.annotation.Async;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

import java.util.HashMap;
import java.util.Map;
import java.util.concurrent.CompletableFuture;

@Service
public class BlockchainServiceImpl implements BlockchainService {
    
    @Value("${blockchain.service.url:http://localhost:8000}")
    private String blockchainServiceUrl;
    
    private final RestTemplate restTemplate = new RestTemplate();
    
    @Override
    @Async
    public CompletableFuture<String> certifyKnowledge(
            Long knowledgeId, Long userId, String contentHash) {
        try {
            String url = blockchainServiceUrl + "/api/blockchain/certify";
            
            Map<String, Object> request = new HashMap<>();
            request.put("type", "KNOWLEDGE_CERT");
            request.put("knowledge_id", knowledgeId);
            request.put("user_id", userId);
            request.put("content_hash", contentHash);
            
            HttpHeaders headers = new HttpHeaders();
            headers.setContentType(MediaType.APPLICATION_JSON);
            HttpEntity<Map<String, Object>> entity = new HttpEntity<>(request, headers);
            
            ResponseEntity<Map> response = restTemplate.postForEntity(url, entity, Map.class);
            
            if (response.getStatusCode().is2xxSuccessful()) {
                Map<String, Object> body = response.getBody();
                return CompletableFuture.completedFuture(
                    body.get("transaction_id").toString()
                );
            }
            
            throw new RuntimeException("Blockchain service error");
        } catch (Exception e) {
            // è®°å½•æ—¥å¿—ï¼Œä½†ä¸å½±å“ä¸»æµç¨‹
            e.printStackTrace();
            return CompletableFuture.completedFuture(null);
        }
    }
    
    @Override
    public BlockchainVerifyResponse verifyKnowledge(
            Long knowledgeId, String contentHash) {
        try {
            String url = blockchainServiceUrl + "/api/blockchain/verify";
            
            Map<String, Object> request = new HashMap<>();
            request.put("knowledge_id", knowledgeId);
            request.put("content_hash", contentHash);
            
            HttpHeaders headers = new HttpHeaders();
            headers.setContentType(MediaType.APPLICATION_JSON);
            HttpEntity<Map<String, Object>> entity = new HttpEntity<>(request, headers);
            
            ResponseEntity<BlockchainVerifyResponse> response = restTemplate.postForEntity(
                url, entity, BlockchainVerifyResponse.class
            );
            
            if (response.getStatusCode().is2xxSuccessful()) {
                return response.getBody();
            }
            
            return BlockchainVerifyResponse.builder()
                .isValid(false)
                .build();
        } catch (Exception e) {
            e.printStackTrace();
            return BlockchainVerifyResponse.builder()
                .isValid(false)
                .build();
        }
    }
    
    @Override
    public Object getTransaction(Long knowledgeId) {
        try {
            String url = blockchainServiceUrl + "/api/blockchain/transaction/" + knowledgeId;
            ResponseEntity<Map> response = restTemplate.getForEntity(url, Map.class);
            return response.getBody();
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
}
```

#### 4.4.3 åœ¨ä¸šåŠ¡æœåŠ¡ä¸­é›†æˆ

```java
@Service
public class KnowledgeItemServiceImpl implements KnowledgeItemService {
    
    @Autowired
    private BlockchainService blockchainService;
    
    @Override
    public KnowledgeItemDTO create(CreateKnowledgeRequest request) {
        // 1. ä¿å­˜åˆ°æ•°æ®åº“
        KnowledgeItem item = saveToDatabase(request);
        
        // 2. è®¡ç®—å†…å®¹å“ˆå¸Œ
        String contentHash = calculateContentHash(item);
        
        // 3. å¼‚æ­¥è°ƒç”¨åŒºå—é“¾å­˜è¯ï¼ˆä¸é˜»å¡ä¸»æµç¨‹ï¼‰
        blockchainService.certifyKnowledge(
            item.getId(),
            item.getUploaderId(),
            contentHash
        );
        
        return convertToDTO(item);
    }
    
    private String calculateContentHash(KnowledgeItem item) {
        String content = item.getTitle() + item.getContent();
        return DigestUtils.sha256Hex(content);
    }
}
```

### 4.5 é…ç½®ç®¡ç†

#### 4.5.1 Spring Booté…ç½®

```yaml
# application.yml
blockchain:
  service:
    url: ${BLOCKCHAIN_SERVICE_URL:http://localhost:8000}
    timeout: 5000
    retry:
      enabled: true
      max-attempts: 3
      backoff: 1000
```

#### 4.5.2 PythonæœåŠ¡é…ç½®

```python
# config.py
import os

class Config:
    # æ•°æ®åº“é…ç½®
    DATABASE_URL = os.getenv("DATABASE_URL", "sqlite:///blockchain.db")
    
    # æœåŠ¡é…ç½®
    HOST = os.getenv("HOST", "0.0.0.0")
    PORT = int(os.getenv("PORT", 8000))
    
    # åŒºå—é“¾é…ç½®
    DIFFICULTY = int(os.getenv("BLOCKCHAIN_DIFFICULTY", 2))
    AUTO_CREATE_BLOCK = os.getenv("AUTO_CREATE_BLOCK", "true").lower() == "true"
    CREATE_BLOCK_INTERVAL = int(os.getenv("CREATE_BLOCK_INTERVAL", 60))  # ç§’
    
    # CORSé…ç½®
    CORS_ORIGINS = os.getenv("CORS_ORIGINS", "*").split(",")
```

### 4.6 éƒ¨ç½²æ–¹æ¡ˆ

#### 4.6.1 Dockeréƒ¨ç½²

```dockerfile
# Dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  blockchain-service:
    build: ./blockchain-service
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db:5432/blockchain
      - BLOCKCHAIN_DIFFICULTY=2
    volumes:
      - ./blockchain-data:/app/data
    depends_on:
      - db
  
  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=blockchain
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pass
    volumes:
      - blockchain-db:/var/lib/postgresql/data

volumes:
  blockchain-db:
```

### 4.7 ä½¿ç”¨åœºæ™¯

#### 4.7.1 çŸ¥è¯†å†…å®¹å­˜è¯

```java
// åˆ›å»ºçŸ¥è¯†å†…å®¹æ—¶è‡ªåŠ¨å­˜è¯
@PostMapping("/knowledge")
public Result<KnowledgeItemDTO> createKnowledge(@RequestBody CreateKnowledgeRequest request) {
    KnowledgeItemDTO item = knowledgeItemService.create(request);
    // å­˜è¯åœ¨æœåŠ¡å±‚å¼‚æ­¥æ‰§è¡Œ
    return Result.success(item);
}
```

#### 4.7.2 ç‰ˆæƒéªŒè¯

```java
// éªŒè¯çŸ¥è¯†å†…å®¹ç‰ˆæƒ
@GetMapping("/knowledge/{id}/verify")
public Result<BlockchainVerifyResponse> verifyKnowledge(
        @PathVariable Long id) {
    KnowledgeItem item = knowledgeItemService.findById(id);
    String contentHash = calculateHash(item);
    BlockchainVerifyResponse response = blockchainService.verifyKnowledge(id, contentHash);
    return Result.success(response);
}
```

#### 4.7.3 æˆå°±è®¤è¯

```java
// ç”¨æˆ·è·å¾—æˆå°±æ—¶ä¸Šé“¾
public void awardAchievement(Long userId, String achievementType) {
    String achievementHash = generateAchievementHash(userId, achievementType);
    blockchainService.certifyAchievement(userId, achievementType, achievementHash);
}
```

---

## 5. æ•°æ®åº“è®¾è®¡

### 5.1 æ•°æ®åº“æ¦‚è¿°

- **æ•°æ®åº“åç§°**: educhain_db
- **å­—ç¬¦é›†**: utf8mb4
- **æ’åºè§„åˆ™**: utf8mb4_unicode_ci
- **å­˜å‚¨å¼•æ“**: InnoDB
- **è¡¨æ•°é‡**: 20å¼ æ ¸å¿ƒè¡¨

### 5.2 æ ¸å¿ƒè¡¨ç»“æ„

#### 5.2.1 ç”¨æˆ·ç›¸å…³è¡¨

**users (ç”¨æˆ·è¡¨)**
```sql
CREATE TABLE users (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    role ENUM('LEARNER', 'ADMIN') NOT NULL DEFAULT 'LEARNER',
    full_name VARCHAR(100),
    avatar_url VARCHAR(500),
    school VARCHAR(100),
    level INT NOT NULL DEFAULT 1,
    bio TEXT,
    status INT NOT NULL DEFAULT 1,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_status (status)
);
```

**user_stats (ç”¨æˆ·ç»Ÿè®¡è¡¨)**
```sql
CREATE TABLE user_stats (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL UNIQUE,
    knowledge_count INT NOT NULL DEFAULT 0,
    like_count INT NOT NULL DEFAULT 0,
    favorite_count INT NOT NULL DEFAULT 0,
    comment_count INT NOT NULL DEFAULT 0,
    follower_count INT NOT NULL DEFAULT 0,
    following_count INT NOT NULL DEFAULT 0,
    view_count BIGINT NOT NULL DEFAULT 0,
    total_score INT NOT NULL DEFAULT 0,
    achievement_count INT NOT NULL DEFAULT 0,
    login_count INT NOT NULL DEFAULT 0,
    last_login_at DATETIME,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

#### 5.2.2 çŸ¥è¯†å†…å®¹ç›¸å…³è¡¨

**knowledge_items (çŸ¥è¯†æ¡ç›®è¡¨)**
```sql
CREATE TABLE knowledge_items (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    content LONGTEXT,
    type ENUM('TEXT', 'IMAGE', 'VIDEO', 'DOCUMENT', 'LINK', 'MIXED') NOT NULL DEFAULT 'TEXT',
    media_urls JSON,
    link_url VARCHAR(500),
    uploader_id BIGINT NOT NULL,
    category_id BIGINT NOT NULL,
    tags VARCHAR(500),
    status INT NOT NULL DEFAULT 1,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (uploader_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE CASCADE,
    INDEX idx_title (title),
    INDEX idx_uploader_id (uploader_id),
    INDEX idx_category_id (category_id),
    INDEX idx_type (type),
    INDEX idx_status (status),
    INDEX idx_created_at (created_at)
);
```

**knowledge_stats (çŸ¥è¯†ç»Ÿè®¡è¡¨)**
```sql
CREATE TABLE knowledge_stats (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    knowledge_id BIGINT NOT NULL UNIQUE,
    view_count BIGINT NOT NULL DEFAULT 0,
    like_count BIGINT NOT NULL DEFAULT 0,
    favorite_count BIGINT NOT NULL DEFAULT 0,
    comment_count BIGINT NOT NULL DEFAULT 0,
    share_count BIGINT NOT NULL DEFAULT 0,
    quality_score DOUBLE DEFAULT 0.0,
    last_view_at DATETIME,
    last_interaction_at DATETIME,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (knowledge_id) REFERENCES knowledge_items(id) ON DELETE CASCADE
);
```

### 5.3 ç´¢å¼•ä¼˜åŒ–

#### 5.3.1 å¤åˆç´¢å¼•

```sql
-- çŸ¥è¯†å†…å®¹æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_knowledge_status_created 
ON knowledge_items(status, created_at DESC);

-- äº’åŠ¨æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_interactions_knowledge_type 
ON user_interactions(knowledge_id, interaction_type);

-- è¯„è®ºæŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_comments_knowledge_created 
ON comments(knowledge_id, created_at DESC);
```

#### 5.3.2 å…¨æ–‡ç´¢å¼•

```sql
-- æœç´¢ä¼˜åŒ–ï¼ˆMySQL 5.7+ï¼‰
ALTER TABLE knowledge_items 
ADD FULLTEXT INDEX ft_title_content (title, content);
```

### 5.4 æ•°æ®å…³ç³»å›¾

```
users (1) â”€â”€< (N) knowledge_items
users (1) â”€â”€< (N) comments
users (1) â”€â”€< (N) user_interactions
users (1) â”€â”€< (N) user_follows (follower)
users (1) â”€â”€< (N) user_follows (following)

categories (1) â”€â”€< (N) knowledge_items
categories (1) â”€â”€< (N) categories (parent)

knowledge_items (1) â”€â”€< (N) comments
knowledge_items (1) â”€â”€< (N) user_interactions
knowledge_items (1) â”€â”€< (1) knowledge_stats
knowledge_items (1) â”€â”€< (N) knowledge_versions
```

---

## 6. API è®¾è®¡è§„èŒƒ

### 6.1 RESTful API è®¾è®¡åŸåˆ™

#### 6.1.1 URLè®¾è®¡

```
GET    /api/knowledge              # è·å–çŸ¥è¯†åˆ—è¡¨
GET    /api/knowledge/{id}         # è·å–çŸ¥è¯†è¯¦æƒ…
POST   /api/knowledge              # åˆ›å»ºçŸ¥è¯†å†…å®¹
PUT    /api/knowledge/{id}         # æ›´æ–°çŸ¥è¯†å†…å®¹
DELETE /api/knowledge/{id}         # åˆ é™¤çŸ¥è¯†å†…å®¹
```

#### 6.1.2 HTTPæ–¹æ³•

- **GET**: æŸ¥è¯¢èµ„æº
- **POST**: åˆ›å»ºèµ„æº
- **PUT**: å®Œæ•´æ›´æ–°èµ„æº
- **PATCH**: éƒ¨åˆ†æ›´æ–°èµ„æº
- **DELETE**: åˆ é™¤èµ„æº

#### 6.1.3 çŠ¶æ€ç 

```java
200 OK              // è¯·æ±‚æˆåŠŸ
201 Created         // èµ„æºåˆ›å»ºæˆåŠŸ
204 No Content      // åˆ é™¤æˆåŠŸ
400 Bad Request     // è¯·æ±‚å‚æ•°é”™è¯¯
401 Unauthorized    // æœªè®¤è¯
403 Forbidden       // æ— æƒé™
404 Not Found       // èµ„æºä¸å­˜åœ¨
409 Conflict        // èµ„æºå†²çª
500 Internal Server Error // æœåŠ¡å™¨é”™è¯¯
```

### 6.2 ç»Ÿä¸€å“åº”æ ¼å¼

```java
public class Result<T> {
    private Integer code;      // çŠ¶æ€ç 
    private String message;    // æ¶ˆæ¯
    private T data;            // æ•°æ®
    private Long timestamp;    // æ—¶é—´æˆ³
    
    public static <T> Result<T> success(T data) {
        return new Result<>(200, "success", data, System.currentTimeMillis());
    }
    
    public static <T> Result<T> error(Integer code, String message) {
        return new Result<>(code, message, null, System.currentTimeMillis());
    }
}
```

### 6.3 APIæ–‡æ¡£

ä½¿ç”¨Swagger/OpenAPIè‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£ï¼š

```java
@RestController
@RequestMapping("/api/knowledge")
@Tag(name = "çŸ¥è¯†å†…å®¹ç®¡ç†", description = "çŸ¥è¯†å†…å®¹çš„CRUDæ“ä½œ")
public class KnowledgeItemController {
    
    @GetMapping
    @Operation(summary = "è·å–çŸ¥è¯†åˆ—è¡¨", description = "æ”¯æŒåˆ†é¡µã€ç­›é€‰ã€æ’åº")
    public Result<Page<KnowledgeItemDTO>> getKnowledgeList(
            @Parameter(description = "é¡µç ") @RequestParam(defaultValue = "0") int page,
            @Parameter(description = "æ¯é¡µæ•°é‡") @RequestParam(defaultValue = "10") int size) {
        // ...
    }
}
```

### 6.4 åˆ†é¡µè§„èŒƒ

```java
// è¯·æ±‚å‚æ•°
GET /api/knowledge?page=0&size=10&sort=createdAt,desc

// å“åº”æ ¼å¼
{
    "code": 200,
    "message": "success",
    "data": {
        "content": [...],
        "totalElements": 100,
        "totalPages": 10,
        "number": 0,
        "size": 10
    }
}
```

---

## 7. å‰åç«¯å¼€å‘æŒ‡å—

### 7.1 åç«¯å¼€å‘æŒ‡å—

#### 7.1.1 é¡¹ç›®ç»“æ„

```
src/main/java/com/example/educhain/
â”œâ”€â”€ controller/      # æ§åˆ¶å™¨å±‚
â”œâ”€â”€ service/         # æœåŠ¡å±‚
â”‚   â””â”€â”€ impl/        # æœåŠ¡å®ç°
â”œâ”€â”€ repository/      # æ•°æ®è®¿é—®å±‚
â”œâ”€â”€ entity/          # å®ä½“ç±»
â”œâ”€â”€ dto/             # æ•°æ®ä¼ è¾“å¯¹è±¡
â”œâ”€â”€ config/          # é…ç½®ç±»
â”œâ”€â”€ util/            # å·¥å…·ç±»
â””â”€â”€ exception/       # å¼‚å¸¸å¤„ç†
```

#### 7.1.2 å¼€å‘è§„èŒƒ

**Controllerå±‚**:
```java
@RestController
@RequestMapping("/api/knowledge")
@RequiredArgsConstructor
@Slf4j
public class KnowledgeItemController {
    
    private final KnowledgeItemService knowledgeItemService;
    
    @GetMapping("/{id}")
    public Result<KnowledgeItemDTO> getKnowledge(@PathVariable Long id) {
        return Result.success(knowledgeItemService.findById(id));
    }
}
```

**Serviceå±‚**:
```java
@Service
@RequiredArgsConstructor
@Transactional
public class KnowledgeItemServiceImpl implements KnowledgeItemService {
    
    private final KnowledgeItemRepository repository;
    
    @Override
    public KnowledgeItemDTO findById(Long id) {
        KnowledgeItem item = repository.findById(id)
            .orElseThrow(() -> new BusinessException("çŸ¥è¯†å†…å®¹ä¸å­˜åœ¨"));
        return convertToDTO(item);
    }
}
```

#### 7.1.3 å¼‚å¸¸å¤„ç†

```java
@ControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(BusinessException.class)
    public Result<?> handleBusinessException(BusinessException e) {
        return Result.error(400, e.getMessage());
    }
    
    @ExceptionHandler(Exception.class)
    public Result<?> handleException(Exception e) {
        log.error("ç³»ç»Ÿå¼‚å¸¸", e);
        return Result.error(500, "ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•");
    }
}
```

### 7.2 å‰ç«¯å¼€å‘æŒ‡å—

#### 7.2.1 é¡¹ç›®ç»“æ„

```
frontend/src/
â”œâ”€â”€ pages/           # é¡µé¢ç»„ä»¶
â”œâ”€â”€ components/      # UIç»„ä»¶
â”œâ”€â”€ services/        # APIæœåŠ¡
â”œâ”€â”€ contexts/        # ä¸Šä¸‹æ–‡
â”œâ”€â”€ hooks/           # è‡ªå®šä¹‰Hooks
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/           # ç±»å‹å®šä¹‰
â””â”€â”€ constants/       # å¸¸é‡
```

#### 7.2.2 ç»„ä»¶å¼€å‘

```tsx
// å‡½æ•°ç»„ä»¶ç¤ºä¾‹
import React from 'react';
import { Button } from 'antd';

interface Props {
  title: string;
  onClick: () => void;
}

const MyComponent: React.FC<Props> = ({ title, onClick }) => {
  return (
    <div>
      <h1>{title}</h1>
      <Button onClick={onClick}>ç‚¹å‡»</Button>
    </div>
  );
};

export default MyComponent;
```

#### 7.2.3 APIè°ƒç”¨

```typescript
// services/knowledge.ts
import api from './api';

export const knowledgeService = {
  getList: (params: any) => 
    api.get('/knowledge', { params }),
  
  getById: (id: number) => 
    api.get(`/knowledge/${id}`),
  
  create: (data: CreateKnowledgeRequest) => 
    api.post('/knowledge', data),
};
```

#### 7.2.4 çŠ¶æ€ç®¡ç†

```tsx
// contexts/AuthContext.tsx
import { createContext, useContext, useState } from 'react';

interface AuthContextType {
  user: User | null;
  login: (token: string) => void;
  logout: () => void;
}

const AuthContext = createContext<AuthContextType | null>(null);

export const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [user, setUser] = useState<User | null>(null);
  
  const login = (token: string) => {
    localStorage.setItem('token', token);
    // è·å–ç”¨æˆ·ä¿¡æ¯
  };
  
  const logout = () => {
    localStorage.removeItem('token');
    setUser(null);
  };
  
  return (
    <AuthContext.Provider value={{ user, login, logout }}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within AuthProvider');
  }
  return context;
};
```

---

## 8. å®‰å…¨æœºåˆ¶

### 8.1 è®¤è¯ä¸æˆæƒ

#### 8.1.1 JWTè®¤è¯

```java
@Component
public class JwtUtil {
    
    @Value("${jwt.secret}")
    private String secret;
    
    @Value("${jwt.expiration}")
    private Long expiration;
    
    public String generateToken(UserDetails userDetails) {
        Map<String, Object> claims = new HashMap<>();
        claims.put("sub", userDetails.getUsername());
        claims.put("roles", userDetails.getAuthorities());
        
        return Jwts.builder()
            .setClaims(claims)
            .setExpiration(new Date(System.currentTimeMillis() + expiration))
            .signWith(SignatureAlgorithm.HS512, secret)
            .compact();
    }
    
    public Boolean validateToken(String token) {
        try {
            Jwts.parser().setSigningKey(secret).parseClaimsJws(token);
            return true;
        } catch (JwtException e) {
            return false;
        }
    }
}
```

#### 8.1.2 Spring Securityé…ç½®

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .csrf().disable()
            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
            .and()
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/api/auth/**").permitAll()
                .requestMatchers("/api/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            )
            .addFilterBefore(jwtAuthenticationFilter(), UsernamePasswordAuthenticationFilter.class);
        
        return http.build();
    }
}
```

### 8.2 æ¥å£é™æµ

#### 8.2.1 é™æµé…ç½®

```java
@Aspect
@Component
public class RateLimitAspect {
    
    @Around("@annotation(rateLimit)")
    public Object rateLimit(ProceedingJoinPoint joinPoint, RateLimit rateLimit) {
        String key = generateKey(joinPoint);
        if (!rateLimiter.tryAcquire(key, rateLimit.limit(), rateLimit.window())) {
            throw new RateLimitException("è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åé‡è¯•");
        }
        return joinPoint.proceed();
    }
}
```

#### 8.2.2 é™æµæ³¨è§£

```java
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface RateLimit {
    int limit() default 100;
    int window() default 60;  // ç§’
    RateLimitType type() default RateLimitType.IP;
}
```

### 8.3 æ•°æ®å®‰å…¨

#### 8.3.1 å¯†ç åŠ å¯†

```java
@Service
public class PasswordEncoder {
    
    private final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
    
    public String encode(String rawPassword) {
        return encoder.encode(rawPassword);
    }
    
    public boolean matches(String rawPassword, String encodedPassword) {
        return encoder.matches(rawPassword, encodedPassword);
    }
}
```

#### 8.3.2 SQLæ³¨å…¥é˜²æŠ¤

- ä½¿ç”¨JPAå‚æ•°åŒ–æŸ¥è¯¢
- é¿å…æ‹¼æ¥SQLè¯­å¥
- è¾“å…¥éªŒè¯å’Œè¿‡æ»¤

#### 8.3.3 XSSé˜²æŠ¤

```java
@Component
public class XssFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                         FilterChain chain) {
        // XSSè¿‡æ»¤é€»è¾‘
        chain.doFilter(new XssHttpServletRequestWrapper((HttpServletRequest) request), 
                      response);
    }
}
```

---

## 9. æ€§èƒ½ä¼˜åŒ–

### 9.1 æ•°æ®åº“ä¼˜åŒ–

#### 9.1.1 ç´¢å¼•ä¼˜åŒ–

- ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåˆ›å»ºç´¢å¼•
- ä½¿ç”¨å¤åˆç´¢å¼•ä¼˜åŒ–å¤šæ¡ä»¶æŸ¥è¯¢
- å®šæœŸåˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—

#### 9.1.2 æŸ¥è¯¢ä¼˜åŒ–

```java
// ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢
Pageable pageable = PageRequest.of(page, size, Sort.by("createdAt").descending());
Page<KnowledgeItem> items = repository.findAll(pageable);

// ä½¿ç”¨æŠ•å½±æŸ¥è¯¢ï¼ˆåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µï¼‰
@Query("SELECT k.id, k.title, k.createdAt FROM KnowledgeItem k")
List<KnowledgeItemProjection> findProjections();
```

### 9.2 ç¼“å­˜ç­–ç•¥

#### 9.2.1 Redisç¼“å­˜

```java
@Service
public class KnowledgeItemService {
    
    @Cacheable(value = "knowledge", key = "#id")
    public KnowledgeItemDTO findById(Long id) {
        return repository.findById(id).map(this::convertToDTO).orElse(null);
    }
    
    @CacheEvict(value = "knowledge", key = "#id")
    public void delete(Long id) {
        repository.deleteById(id);
    }
}
```

#### 9.2.2 ç¼“å­˜é…ç½®

```java
@Configuration
@EnableCaching
public class CacheConfig {
    
    @Bean
    public CacheManager cacheManager(RedisConnectionFactory factory) {
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofHours(1))
            .serializeKeysWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new GenericJackson2JsonRedisSerializer()));
        
        return RedisCacheManager.builder(factory)
            .cacheDefaults(config)
            .build();
    }
}
```

### 9.3 å‰ç«¯ä¼˜åŒ–

#### 9.3.1 ä»£ç åˆ†å‰²

```tsx
// è·¯ç”±æ‡’åŠ è½½
const KnowledgeList = React.lazy(() => import('@/pages/knowledge/KnowledgeList'));

<Suspense fallback={<Loading />}>
  <KnowledgeList />
</Suspense>
```

#### 9.3.2 å›¾ç‰‡ä¼˜åŒ–

- ä½¿ç”¨WebPæ ¼å¼
- å›¾ç‰‡æ‡’åŠ è½½
- CDNåŠ é€Ÿ

#### 9.3.3 æ‰“åŒ…ä¼˜åŒ–

```typescript
// vite.config.ts
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom'],
          'antd-vendor': ['antd'],
        },
      },
    },
  },
});
```

---

## 10. éƒ¨ç½²æ–¹æ¡ˆ

### 10.1 Dockeréƒ¨ç½²

#### 10.1.1 åç«¯Dockerfile

```dockerfile
FROM openjdk:21-jdk-slim

WORKDIR /app

COPY target/EduChain-0.0.1-SNAPSHOT.jar app.jar

EXPOSE 8080

ENTRYPOINT ["java", "-jar", "app.jar"]
```

#### 10.1.2 å‰ç«¯Dockerfile

```dockerfile
FROM node:20-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

FROM nginx:alpine

COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

#### 10.1.3 Docker Compose

```yaml
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: ${DB_PASSWORD}
      MYSQL_DATABASE: educhain_db
    volumes:
      - mysql-data:/var/lib/mysql
    ports:
      - "3306:3306"
  
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
  
  backend:
    build: .
    ports:
      - "8080:8080"
    environment:
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/educhain_db
      - SPRING_REDIS_HOST=redis
    depends_on:
      - mysql
      - redis
  
  frontend:
    build: ./frontend
    ports:
      - "80:80"
    depends_on:
      - backend
  
  blockchain:
    build: ./blockchain-service
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@postgres:5432/blockchain
    depends_on:
      - postgres
  
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: blockchain
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
    volumes:
      - postgres-data:/var/lib/postgresql/data

volumes:
  mysql-data:
  redis-data:
  postgres-data:
```

### 10.2 ç¯å¢ƒé…ç½®

#### 10.2.1 å¼€å‘ç¯å¢ƒ

```yaml
# application-dev.yml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/educhain_db_dev
  jpa:
    show-sql: true
logging:
  level:
    com.example.educhain: DEBUG
```

#### 10.2.2 ç”Ÿäº§ç¯å¢ƒ

```yaml
# application-prod.yml
spring:
  datasource:
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
  jpa:
    show-sql: false
logging:
  level:
    root: WARN
    com.example.educhain: INFO
```

---

## 11. å¼€å‘è§„èŒƒ

### 11.1 ä»£ç è§„èŒƒ

#### 11.1.1 Javaä»£ç è§„èŒƒ

- éµå¾ªGoogle Java Style Guide
- ä½¿ç”¨Spotlessè‡ªåŠ¨æ ¼å¼åŒ–
- ç±»åä½¿ç”¨å¤§é©¼å³°
- æ–¹æ³•åä½¿ç”¨å°é©¼å³°
- å¸¸é‡ä½¿ç”¨å¤§å†™ä¸‹åˆ’çº¿

#### 11.1.2 TypeScriptä»£ç è§„èŒƒ

- ä½¿ç”¨ESLint + Prettier
- å‡½æ•°ç»„ä»¶ä¼˜å…ˆ
- ä½¿ç”¨TypeScriptä¸¥æ ¼æ¨¡å¼
- æ¥å£å‘½åä½¿ç”¨å¤§é©¼å³°
- å˜é‡å‘½åä½¿ç”¨å°é©¼å³°

### 11.2 Gitå·¥ä½œæµ

#### 11.2.1 åˆ†æ”¯ç­–ç•¥

```
main          # ä¸»åˆ†æ”¯ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
â”œâ”€â”€ develop   # å¼€å‘åˆ†æ”¯
â”œâ”€â”€ feature/* # åŠŸèƒ½åˆ†æ”¯
â”œâ”€â”€ bugfix/*  # ä¿®å¤åˆ†æ”¯
â””â”€â”€ hotfix/*  # çƒ­ä¿®å¤åˆ†æ”¯
```

#### 11.2.2 æäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼
refactor: é‡æ„
test: æµ‹è¯•
chore: æ„å»º/å·¥å…·
```

### 11.3 æ³¨é‡Šè§„èŒƒ

```java
/**
 * çŸ¥è¯†å†…å®¹æœåŠ¡å®ç°ç±»
 * 
 * @author EduChain Team
 * @since 1.0.0
 */
@Service
public class KnowledgeItemServiceImpl implements KnowledgeItemService {
    
    /**
     * æ ¹æ®IDæŸ¥æ‰¾çŸ¥è¯†å†…å®¹
     * 
     * @param id çŸ¥è¯†å†…å®¹ID
     * @return çŸ¥è¯†å†…å®¹DTO
     * @throws BusinessException å½“çŸ¥è¯†å†…å®¹ä¸å­˜åœ¨æ—¶
     */
    @Override
    public KnowledgeItemDTO findById(Long id) {
        // å®ç°é€»è¾‘
    }
}
```

---

## 12. æµ‹è¯•ç­–ç•¥

### 12.1 å•å…ƒæµ‹è¯•

```java
@SpringBootTest
class KnowledgeItemServiceTest {
    
    @Autowired
    private KnowledgeItemService service;
    
    @Test
    void testFindById() {
        KnowledgeItemDTO dto = service.findById(1L);
        assertNotNull(dto);
        assertEquals(1L, dto.getId());
    }
}
```

### 12.2 é›†æˆæµ‹è¯•

```java
@SpringBootTest
@AutoConfigureMockMvc
class KnowledgeItemControllerTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @Test
    void testGetKnowledge() throws Exception {
        mockMvc.perform(get("/api/knowledge/1"))
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.code").value(200));
    }
}
```

### 12.3 å‰ç«¯æµ‹è¯•

```typescript
// ç»„ä»¶æµ‹è¯•
import { render, screen } from '@testing-library/react';
import KnowledgeCard from './KnowledgeCard';

test('renders knowledge card', () => {
  render(<KnowledgeCard title="Test" />);
  expect(screen.getByText('Test')).toBeInTheDocument();
});
```

---

## 13. ç›‘æ§ä¸è¿ç»´

### 13.1 æ—¥å¿—ç®¡ç†

#### 13.1.1 æ—¥å¿—é…ç½®

```yaml
logging:
  level:
    root: INFO
    com.example.educhain: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/educhain.log
    max-size: 10MB
    max-history: 30
```

#### 13.1.2 æ—¥å¿—çº§åˆ«

- **DEBUG**: è°ƒè¯•ä¿¡æ¯
- **INFO**: ä¸€èˆ¬ä¿¡æ¯
- **WARN**: è­¦å‘Šä¿¡æ¯
- **ERROR**: é”™è¯¯ä¿¡æ¯

### 13.2 ç›‘æ§æŒ‡æ ‡

#### 13.2.1 Spring Boot Actuator

```yaml
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized
```

#### 13.2.2 å…³é”®æŒ‡æ ‡

- APIå“åº”æ—¶é—´
- æ•°æ®åº“è¿æ¥æ± çŠ¶æ€
- Redisè¿æ¥çŠ¶æ€
- JVMå†…å­˜ä½¿ç”¨
- é”™è¯¯ç‡

### 13.3 å‘Šè­¦æœºåˆ¶

- é”™è¯¯ç‡è¶…è¿‡é˜ˆå€¼
- å“åº”æ—¶é—´è¿‡é•¿
- æ•°æ®åº“è¿æ¥å¼‚å¸¸
- æœåŠ¡ä¸å¯ç”¨

---

## é™„å½•

### A. æŠ€æœ¯æ ˆç‰ˆæœ¬

| æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|
| Java | 21 |
| Spring Boot | 3.2.0 |
| React | 19.2.0 |
| TypeScript | 5.9.3 |
| MySQL | 8.0+ |
| Redis | 7+ |
| Python | 3.11+ |
| FastAPI | Latest |

### B. å‚è€ƒèµ„æº

- [Spring Bootå®˜æ–¹æ–‡æ¡£](https://spring.io/projects/spring-boot)
- [Reactå®˜æ–¹æ–‡æ¡£](https://react.dev)
- [Ant Designæ–‡æ¡£](https://ant.design)
- [FastAPIæ–‡æ¡£](https://fastapi.tiangolo.com)

### C. è”ç³»æ–¹å¼

- **é¡¹ç›®ä»“åº“**: [GitHub Repository]
- **é—®é¢˜åé¦ˆ**: [Issue Tracker]
- **æŠ€æœ¯æ–‡æ¡£**: [Documentation Site]

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2025-01-01  
**ç»´æŠ¤è€…**: EduChain å¼€å‘å›¢é˜Ÿ

