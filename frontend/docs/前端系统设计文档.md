# EduChain 前端系统设计文档

## 文档信息

| 项目 | 内容 |
|------|------|
| 项目名称 | EduChain 基于区块链存证的教育知识共享与智能检索系统前端 |
| 技术栈 | React 19 + TypeScript + Vite |
| UI框架 | Ant Design 6.0 |
| 版本 | 1.0.0 |

---

## 一、项目概述

### 1.1 项目简介

EduChain前端是基于区块链存证的教育知识共享与智能检索系统的用户界面层，采用现代化的React技术栈构建，提供流畅的用户体验和丰富的交互功能。

### 1.2 核心功能

| 功能模块 | 说明 |
|----------|------|
| 用户认证 | 登录、注册、权限管理 |
| 知识管理 | 浏览、创建、编辑、搜索知识内容 |
| 社区互动 | 评论、点赞、收藏、关注 |
| 区块链存证 | 内容存证、证书验证、区块浏览 |
| 个人中心 | 个人资料、我的内容、通知消息 |
| 后台管理 | 用户管理、内容管理、系统监控 |

### 1.3 技术选型

| 技术 | 版本 | 用途 |
|------|------|------|
| React | 19.2.0 | UI框架 |
| TypeScript | 5.9.3 | 类型安全 |
| Vite | 7.2.4 | 构建工具 |
| Ant Design | 6.0.0 | UI组件库 |
| React Router | 7.9.6 | 路由管理 |
| Axios | 1.13.2 | HTTP客户端 |
| Day.js | 1.11.19 | 日期处理 |
| MSW | 2.12.4 | Mock服务 |

---

## 二、系统架构

### 2.1 整体架构图


```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        EduChain 前端系统架构                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                          视图层 (Pages)                              │   │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│  │  │  首页   │ │知识模块 │ │搜索模块 │ │区块链  │ │后台管理 │       │   │
│  │  │  Home   │ │Knowledge│ │ Search  │ │Blockchain│ │ Admin   │       │   │
│  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                        │
│                                    ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         组件层 (Components)                          │   │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│  │  │ Layout  │ │ Common  │ │Knowledge│ │Blockchain│ │  Search │       │   │
│  │  │ 布局组件 │ │ 通用组件 │ │知识组件 │ │区块链组件│ │ 搜索组件 │       │   │
│  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                        │
│                                    ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         状态层 (State)                               │   │
│  │  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐            │   │
│  │  │  AuthContext  │  │ ThemeContext  │  │  AppContext   │            │   │
│  │  │   认证状态     │  │   主题状态     │  │   应用状态    │            │   │
│  │  └───────────────┘  └───────────────┘  └───────────────┘            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                        │
│                                    ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         服务层 (Services)                            │   │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │   │
│  │  │  Auth   │ │Knowledge│ │ Search  │ │Blockchain│ │  User   │       │   │
│  │  │ 认证服务 │ │知识服务 │ │ 搜索服务 │ │区块链服务│ │ 用户服务 │       │   │
│  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                        │
│                                    ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         网络层 (API)                                 │   │
│  │  ┌───────────────────────────────────────────────────────────────┐  │   │
│  │  │                    Axios + 拦截器                              │  │   │
│  │  │              Token管理 / 错误处理 / 缓存                        │  │   │
│  │  └───────────────────────────────────────────────────────────────┘  │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 目录结构

```
frontend/
├── public/                    # 静态资源
│   └── mockServiceWorker.js   # MSW Service Worker
├── src/
│   ├── assets/               # 静态资源（图片、字体等）
│   ├── components/           # 可复用组件
│   │   ├── admin/           # 管理后台组件
│   │   ├── blockchain/      # 区块链相关组件
│   │   ├── common/          # 通用组件
│   │   ├── knowledge/       # 知识内容组件
│   │   ├── layout/          # 布局组件
│   │   ├── recommendation/  # 推荐组件
│   │   ├── search/          # 搜索组件
│   │   └── ui/              # 基础UI组件
│   ├── constants/           # 常量定义
│   ├── contexts/            # React Context
│   ├── hooks/               # 自定义Hooks
│   ├── mock/                # Mock数据和服务
│   │   ├── data/           # Mock数据
│   │   └── utils/          # Mock工具
│   ├── pages/               # 页面组件
│   │   ├── admin/          # 管理后台页面
│   │   ├── auth/           # 认证页面
│   │   ├── blockchain/     # 区块链页面
│   │   ├── community/      # 社区页面
│   │   ├── error/          # 错误页面
│   │   ├── knowledge/      # 知识内容页面
│   │   ├── legal/          # 法律条款页面
│   │   ├── recommendation/ # 推荐页面
│   │   ├── resources/      # 资源页面
│   │   ├── search/         # 搜索页面
│   │   └── user/           # 用户页面
│   ├── router/              # 路由配置
│   ├── services/            # API服务
│   ├── styles/              # 全局样式
│   ├── types/               # TypeScript类型定义
│   ├── utils/               # 工具函数
│   ├── App.tsx              # 应用根组件
│   ├── main.tsx             # 应用入口
│   └── index.css            # 全局CSS
├── index.html               # HTML模板
├── package.json             # 项目配置
├── tsconfig.json            # TypeScript配置
├── vite.config.ts           # Vite配置
└── eslint.config.js         # ESLint配置
```

---

## 三、核心模块设计

### 3.1 路由设计

#### 3.1.1 路由结构

| 路径 | 页面 | 权限 | 说明 |
|------|------|------|------|
| `/` | Home | 公开 | 首页 |
| `/login` | Login | 公开 | 登录页 |
| `/register` | Register | 公开 | 注册页 |
| `/knowledge` | KnowledgeList | 公开 | 知识列表 |
| `/knowledge/:shareCode` | KnowledgeDetail | 公开 | 知识详情 |
| `/knowledge/create` | CreateKnowledge | 登录 | 创建知识 |
| `/search` | Search | 公开 | 搜索页 |
| `/search/advanced` | AdvancedSearch | 公开 | 高级搜索 |
| `/blockchain` | BlockchainExplorer | 公开 | 区块链浏览器 |
| `/blockchain/block/:index` | BlockDetail | 公开 | 区块详情 |
| `/profile` | Profile | 登录 | 个人中心 |
| `/admin` | AdminDashboard | 管理员 | 管理后台 |
| `/admin/users` | UserManagement | 管理员 | 用户管理 |
| `/admin/knowledge` | ContentManagement | 管理员 | 内容管理 |

#### 3.1.2 路由守卫

```typescript
// ProtectedRoute组件
<ProtectedRoute roles={['ADMIN']}>
  <AdminLayout />
</ProtectedRoute>
```

### 3.2 状态管理

#### 3.2.1 Context设计

| Context | 用途 | 主要状态 |
|---------|------|----------|
| AuthContext | 认证管理 | user, token, isAuthenticated |
| ThemeContext | 主题管理 | mode, config |
| AppContext | 应用状态 | loading, error |

#### 3.2.2 AuthContext

```typescript
interface AuthContextType {
  user: User | null;
  token: string | null;
  loading: boolean;
  isAuthenticated: boolean;
  login: (username: string, password: string) => Promise<User>;
  logout: () => void;
  register: (data: RegisterData) => Promise<void>;
  updateUser: (user: User) => void;
}
```

#### 3.2.3 ThemeContext

```typescript
interface ThemeContextType {
  mode: 'light' | 'dark';
  config: ThemeConfig;
  toggleMode: () => void;
  setMode: (mode: ThemeMode) => void;
  updateConfig: (config: Partial<ThemeConfig>) => void;
}
```

### 3.3 服务层设计

#### 3.3.1 API服务架构

```typescript
// 基础请求封装
const api = axios.create({
  baseURL: '/api',
  timeout: 10000,
});

// 请求拦截器
api.interceptors.request.use(config => {
  const token = TokenManager.getStoredToken();
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// 响应拦截器
api.interceptors.response.use(
  response => response,
  error => handleApiError(error)
);
```

#### 3.3.2 服务模块

| 服务 | 文件 | 功能 |
|------|------|------|
| authService | auth.ts | 登录、注册、Token刷新 |
| knowledgeService | knowledge.ts | 知识CRUD、搜索 |
| userService | user.ts | 用户信息、统计 |
| searchService | search.ts | 搜索、热词 |
| blockchainService | blockchain.ts | 存证、验证 |
| interactionService | interaction.ts | 点赞、收藏、评论 |

---


## 四、组件设计

### 4.1 组件分类

| 类型 | 目录 | 说明 |
|------|------|------|
| 布局组件 | components/layout | Header, Footer, Layout, AdminLayout |
| 通用组件 | components/common | Loading, ErrorBoundary, ProtectedRoute |
| 业务组件 | components/knowledge | KnowledgeCard, CommentList, TagCloud |
| 区块链组件 | components/blockchain | BlockList, CertificationProgress |
| 搜索组件 | components/search | SearchInput, SearchFilters, SearchResults |

### 4.2 核心组件说明

#### 4.2.1 Layout组件

```typescript
// 主布局组件
const Layout: React.FC = () => {
  return (
    <AntLayout>
      <Header />
      <Content>
        <Outlet />
      </Content>
      <Footer />
    </AntLayout>
  );
};
```

#### 4.2.2 KnowledgeCard组件

```typescript
interface KnowledgeCardProps {
  item: KnowledgeItem;
  onClick?: () => void;
  showStats?: boolean;
}

const KnowledgeCard: React.FC<KnowledgeCardProps> = ({
  item,
  onClick,
  showStats = true
}) => {
  // 展示知识内容卡片
};
```

#### 4.2.3 ProtectedRoute组件

```typescript
interface ProtectedRouteProps {
  children: ReactNode;
  roles?: ('ADMIN' | 'LEARNER')[];
}

const ProtectedRoute: React.FC<ProtectedRouteProps> = ({
  children,
  roles
}) => {
  const { isAuthenticated, user } = useAuth();
  
  if (!isAuthenticated) {
    return <Navigate to="/login" />;
  }
  
  if (roles && !roles.includes(user?.role)) {
    return <Navigate to="/403" />;
  }
  
  return children;
};
```

### 4.3 自定义Hooks

| Hook | 文件 | 功能 |
|------|------|------|
| useAuth | AuthContext.tsx | 获取认证状态和方法 |
| useTheme | ThemeContext.tsx | 获取主题状态和方法 |
| useDebounce | useDebounce.ts | 防抖处理 |
| usePagination | usePagination.ts | 分页逻辑 |
| useLocalStorage | useLocalStorage.ts | 本地存储 |
| usePermissions | usePermissions.ts | 权限检查 |
| useErrorHandler | useErrorHandler.ts | 错误处理 |

---

## 五、页面设计

### 5.1 页面列表

#### 5.1.1 公共页面

| 页面 | 路径 | 组件 | 说明 |
|------|------|------|------|
| 首页 | / | Home.tsx | 平台首页，展示推荐内容 |
| 登录 | /login | Login.tsx | 用户登录 |
| 注册 | /register | Register.tsx | 用户注册 |
| 知识列表 | /knowledge | KnowledgeList.tsx | 知识内容列表 |
| 知识详情 | /knowledge/:shareCode | KnowledgeDetail.tsx | 知识内容详情 |
| 搜索 | /search | Search.tsx | 搜索页面 |
| 社区 | /community | Community.tsx | 社区交流 |

#### 5.1.2 区块链页面

| 页面 | 路径 | 组件 | 说明 |
|------|------|------|------|
| 区块链浏览器 | /blockchain | BlockchainExplorer.tsx | 区块链概览 |
| 区块详情 | /blockchain/block/:index | BlockDetail.tsx | 区块详情 |
| 交易详情 | /blockchain/transaction/:id | TransactionDetail.tsx | 交易详情 |
| 证书验证 | /blockchain/certificates/:id/verify | CertificateVerify.tsx | 证书验证 |

#### 5.1.3 用户页面

| 页面 | 路径 | 组件 | 说明 |
|------|------|------|------|
| 个人中心 | /profile | Profile.tsx | 个人资料管理 |
| 通知中心 | /notifications | Notifications.tsx | 消息通知 |
| 关注列表 | /follow | FollowPage.tsx | 关注/粉丝列表 |

#### 5.1.4 管理后台页面

| 页面 | 路径 | 组件 | 说明 |
|------|------|------|------|
| 管理后台首页 | /admin | AdminDashboard.tsx | 数据概览 |
| 用户管理 | /admin/users | UserManagement.tsx | 用户CRUD |
| 内容管理 | /admin/knowledge | ContentManagement.tsx | 内容审核 |
| 分类管理 | /admin/categories | CategoryManagement.tsx | 分类管理 |
| 系统监控 | /admin/statistics | SystemMonitoring.tsx | 系统状态 |
| 系统日志 | /admin/logs | SystemLogs.tsx | 操作日志 |

### 5.2 页面交互流程

#### 5.2.1 用户登录流程

```
┌─────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  用户    │     │  Login页面   │     │ AuthContext │     │   后端API   │
└────┬────┘     └──────┬──────┘     └──────┬──────┘     └──────┬──────┘
     │                 │                   │                   │
     │  1.输入账号密码  │                   │                   │
     │────────────────▶│                   │                   │
     │                 │                   │                   │
     │                 │  2.调用login()    │                   │
     │                 │──────────────────▶│                   │
     │                 │                   │                   │
     │                 │                   │  3.POST /auth/login
     │                 │                   │──────────────────▶│
     │                 │                   │                   │
     │                 │                   │  4.返回Token+User │
     │                 │                   │◀──────────────────│
     │                 │                   │                   │
     │                 │                   │  5.存储Token      │
     │                 │                   │  更新状态         │
     │                 │                   │                   │
     │                 │  6.登录成功       │                   │
     │                 │◀──────────────────│                   │
     │                 │                   │                   │
     │  7.跳转首页     │                   │                   │
     │◀────────────────│                   │                   │
```

#### 5.2.2 知识创建流程

```
┌─────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  用户    │     │CreateKnowledge│    │knowledgeService│   │   后端API   │
└────┬────┘     └──────┬──────┘     └──────┬──────┘     └──────┬──────┘
     │                 │                   │                   │
     │  1.填写内容     │                   │                   │
     │────────────────▶│                   │                   │
     │                 │                   │                   │
     │                 │  2.表单验证       │                   │
     │                 │                   │                   │
     │                 │  3.上传文件(可选) │                   │
     │                 │──────────────────▶│                   │
     │                 │                   │──────────────────▶│
     │                 │                   │◀──────────────────│
     │                 │                   │                   │
     │                 │  4.创建知识       │                   │
     │                 │──────────────────▶│                   │
     │                 │                   │──────────────────▶│
     │                 │                   │◀──────────────────│
     │                 │                   │                   │
     │  5.创建成功     │                   │                   │
     │◀────────────────│                   │                   │
     │                 │                   │                   │
     │  6.跳转详情页   │                   │                   │
```

---

## 六、样式设计

### 6.1 样式架构

| 文件 | 用途 |
|------|------|
| globals.css | 全局样式、CSS变量 |
| theme-variables.css | 主题变量定义 |
| theme-antd.css | Ant Design主题覆盖 |
| animations.css | 动画效果 |
| glass-effects.css | 毛玻璃效果 |
| performance.css | 性能优化样式 |

### 6.2 主题系统

```css
/* 亮色主题变量 */
:root {
  --primary-color: #1890ff;
  --bg-color: #ffffff;
  --text-color: #333333;
  --border-color: #d9d9d9;
}

/* 暗色主题变量 */
[data-theme='dark'] {
  --primary-color: #177ddc;
  --bg-color: #141414;
  --text-color: #ffffff;
  --border-color: #434343;
}
```

### 6.3 响应式设计

```css
/* 断点定义 */
@media (max-width: 576px) { /* xs */ }
@media (max-width: 768px) { /* sm */ }
@media (max-width: 992px) { /* md */ }
@media (max-width: 1200px) { /* lg */ }
@media (max-width: 1600px) { /* xl */ }
```

---

## 七、Mock服务

### 7.1 Mock架构

使用MSW (Mock Service Worker) 实现前端Mock服务。

```typescript
// mock/index.ts
export const initMock = async () => {
  if (import.meta.env.MODE === 'mock') {
    const { worker } = await import('./server');
    await worker.start();
  }
};
```

### 7.2 Mock数据模块

| 模块 | 文件 | 说明 |
|------|------|------|
| 用户数据 | users.ts | 用户列表、认证数据 |
| 知识数据 | knowledge.ts | 知识内容列表 |
| 分类数据 | categories.ts | 分类树结构 |
| 评论数据 | comments.ts | 评论列表 |
| 区块链数据 | blockchain.ts | 区块、交易数据 |
| 搜索数据 | search.ts | 搜索结果、热词 |

### 7.3 启动Mock模式

```bash
# 开发模式（使用Mock）
npm run dev:mock

# 构建Mock版本
npm run build:mock
```

---

## 八、性能优化

### 8.1 代码分割

```typescript
// 路由懒加载
const HomePage = React.lazy(() => import('../pages/Home'));
const KnowledgeListPage = React.lazy(() => import('../pages/knowledge/KnowledgeList'));
```

### 8.2 缓存策略

```typescript
// API缓存
export const request = {
  get: <T>(url: string, config?: { useCache?: boolean; cacheTtl?: number }) => {
    if (config?.useCache) {
      const cacheKey = generateCacheKey(url, config.params);
      return withCache(() => api.get(url), cacheKey, config.cacheTtl);
    }
    return api.get(url);
  }
};
```

### 8.3 性能优化措施

| 优化项 | 实现方式 |
|--------|----------|
| 路由懒加载 | React.lazy + Suspense |
| 组件缓存 | React.memo |
| 防抖节流 | useDebounce Hook |
| 虚拟列表 | 大数据列表优化 |
| 图片懒加载 | loading="lazy" |
| 请求缓存 | 自定义缓存工具 |

---

## 九、部署配置

### 9.1 环境变量

| 变量 | 说明 | 示例 |
|------|------|------|
| VITE_API_BASE_URL | API基础URL | /api |
| VITE_APP_TITLE | 应用标题 | EduChain |
| MODE | 运行模式 | development/mock/production |

### 9.2 构建命令

```bash
# 开发模式
npm run dev

# Mock开发模式
npm run dev:mock

# 生产构建
npm run build

# Mock构建
npm run build:mock

# 预览构建结果
npm run preview
```

### 9.3 Vite配置

```typescript
export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@components': path.resolve(__dirname, './src/components'),
      '@pages': path.resolve(__dirname, './src/pages'),
      '@services': path.resolve(__dirname, './src/services'),
    },
  },
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
      },
    },
  },
});
```

---

**文档结束**

*本文档详细描述了EduChain前端系统的架构设计，可作为毕业设计的前端技术文档使用。*
